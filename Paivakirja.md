# Projektin kehittämispäiväkirja
| Päivämäärä   | Aiheet   |
|-------------|-------------|
| __25.3__ | Projektin kehittäminen aloitettu. Templatena käytetään Blank templatea ja kielenä TypeScriptiä. Alun perin valittu käytettäväksi React Native Paper komponenttikirjastoa ja Bottom Tabs navigaatiota. Tutkin mahdollisuuksia expo routerin ja react nativen navigaatioiden välillä. Päädyin React Native navigaatioon, mutta tutkin vielä Expon mahdollisuuksia https://docs.expo.dev/router/migrate/from-react-navigation/ |
| __28.3__ | Tuotettu autentikaatio. Tutkittu myös mahdollisuuksia firebasen configin tallentamiseen tietoturvallisesti. Päädyin tässä vaiheessa vielä laittamaan kaikki config tiedot .env:iin, joka on gitignoressa. Mikäli tiedoille löytyy sopiva paikka ja esimerkiksi sattuisinkin vaikka käyttämään esimerkiksi EAS buildia, tulen tähän palaamaan. Kuitenkin tässä vaiheessa arkaluontoisia tietoja ei ole järkevää laittaa GitHubiin, joten siksi työskennellään public env variableilla.<br><br> Aion kirjautumisessa käyttää contextia sillä koodista tulee siistimpää, sitä on helpompaa lukea ja ymmärtää. Tämän lisäksi tilanhallinta helpompaa. Sain tästä videosta hyvin vinkkejä: https://www.youtube.com/watch?v=9NZwiQAye1g&ab_channel=CleverProgrammer. Päätin tehdä useAuthista custom Hookin modulaarisuuden säilyttämiseksi. Löysin apua tästä videosta contextin, erityisesti authcontextproviderin toimintaan ja sain ongelmani ratkaistua seuraamalla tutoriaalia: https://www.youtube.com/watch?v=x62aBvnRCKw&t=1072s&ab_channel=CodeCommerce. Tällä hetkellä vain on lisätty email ja password register, mutta tulen lisäämään ainakin googlen vielä! |
| __31.3__ | Auth Flowsin avulla aiemmin suunniteltu flow kirjautuneen ja ei kirjautuneen käyttäjän välillä toteutettu. Tässä dokumentaatio: https://reactnavigation.org/docs/auth-flow/. Tehty kahdella eri tavalla navigatorit (NoAuthNavigation ja AppNavigation), ei kirjautunut käyttäjä käyttää Stack Navia (register ja login) ja mikäli aiemmin luotu useAuth hookin auth on olemassa, käytetään Bottom Tabs navigaatiota, joka on itse sovelluksen päänavigaatio. Tällä hetkellä vielä ei ole toteutettu muita kirjautumisvaihtoehtoja, kun email ja password, mutta mahdollisimman pian lisätään Google. Rekisteröinti ja kirjautuminen täysin alkutekijöissään, eikä tässä vaiheessa ole vielä ulkoasuun kiinnitetty huomiota. Toimintalogiikka kuitenkin vaikuttaa toimivan. |
| __1.4__ | Tehty modulaarisuuden vuoksi useampia eri kansioita jonne sovellusta jaetaan osiin. Muistiinpanoksi itselle, muista laittaa async storage kuntoon, jotta joka kerta ei tarvitse kirjautua järjestelmään uudelleen |
| __2.4__ | Toteutettu navigaation vaihtaminen kirjautumisen ja rekisteröitymisen välillä ja laitettu ulkoasua heiman siistimmäksi. Lisätty FadeIn animaatiokomponentti, jossa hyödynnettiin Reanimated kirjastoa. Navigaation vaihtamisessa TypeScript tyypitysongelmia, joiden ratkaisemiseksi käytin https://reactnavigation.org/docs/typescript/ sekä ChatGPT 4o tekoälymallia. Ongelmana oli, että navigation.navigate("Register") reitti ei ollut oikein tyypitetty. Loin uuden tyypin types.ts tiedostoon ja käytin tätä navigationin luonnissa. Täten virheilmoitus saatiin pois (navigointi toimi siis vaikka tyyppivirhe olikin). Etusivun saavutettavuutta mietitty ihan uudella tavalla. Asetettu ikoneita, buttoni ja tekstilinkki. Keyboard dismiss laitettu TouchableWithoutFeedbackiin ja KeyboardAvoidingView laitettu, jotta keyboard avautuessaan ei peitä sisältöä |
| __7.4__ | Itse pelilogiikkaa aloitettu. Päätin, että sanan mitta valitaan modaalilla ennen pelin alkua. Tällöin voin toimittaa mitan suoraan peliscreenille useRoute ja paramsia käyttäen. Contekstin käyttäminen ei tässä tapauksessa ole järkevää, koska sana haetaan jokaisella pelikerralla uudelleen. <br><br> Huomasin ongelmaksi hitaat siirtymät screenien yms välillä. Tämän vuoksi loinkin universaalin activityindicator komponentin, jotta käyttäjät näkee milloin ollaan siirtymässä latausta vaativaan kohtaan. <br><br> Huomasin myös ongelmia aiemmin valitsemani tab (bottom tabs) navigaation kanssa. Kuten aiemmin tullut sanotuksi, bottom tabsit tulivat vasta käyttöön, kun oltiin kirjauduttu. Kuitenkin haluan, että peli alkaisi nappia painamalla, eikä bottom tabista ja näiden yhdistäminen vaatisi lisätekemistä. Löysin kuitenkin ohjeen tähän https://reactnavigation.org/docs/nesting-navigators/, mutta päätin kuitenkin tehdä stack navigaation myös tästä aiemmin bottom tabseina olleesta navigaatiosta yksinkertaisen logiikan säilyttämiseksi. |
| __9.4__ | Päivä alkoi ongelmalla, joka ilmeisesti on hyvin tyypillinen TypeScriptille. Expo Go:n käynnistäminen ilmoitti, että käytössä ei ole asyncstoragea ja antoi ohjeet, miten se voidaan laittaa. Typescript ei jostain syystä kuitenkaan huolinut tätä ohjetta, mikä vuoksi aloin Googlailla ongelmaa. Löysin vastauksen täältä: https://stackoverflow.com/questions/76914913/cannot-import-getreactnativepersistence-in-firebase10-1-0, jossa kerrottiin, että tsconfigia muuttamalla ongelma voitaisiin ratkaista. Sen avulla sain asyncin toimimaan, mutta nyt kirjatuessa asyncin avulla, kirjautumisscreeni flashaa pikaisesti ennen kun käyttäjä pääsee itse appiin sisään. Käytin ratkaisuna expon SplashScreenia, jolla LoginScreeni piilotataan alussa. Tämän lisäksi lisäsin authcontextiin loading tilan, joka näyttää milloin kirjautumista haetaan. Tätä käytetään nyt myös App.tsx tasolla, jolloin kirjautumista ladatessa näytetään Loading custom komponentti (joka olisi tarkoitus animoida lähiaikoina näyttämään entistä paremmalta). <br><br> Laitettu myös nyt Firestore DB toimimaan. Ei suurempia ongelmia vielä tässä vaiheessa sen suhteen, mutta päätin lisätä nyt samalla rekisteröitymiseen usernamen, joka tulee kanssa tallentaa firebaseen. Nyt samaan dociin tallennetaan email, username sekä pelin tiedot. En ole varma onko tämä hyvä valinta, mutta tutkin asiaa ja tällä ainakin mahdollistetaan mahdollisimman yksinkertainen datan hakeminen, sillä kaikki on samassa paikassa. Palaan tähän arkkitehtuuriin kuitenkin vielä. Tutkin myös firestoren merge: true mahdollisuutta ja päätin jättää sen varmuuden vuoksi päälle, sillä siitä ei ilmeisemmin ole haittaakaan. Luulen, kuitenkin, että sille ei välttämättä ole tarvetta, sillä pelaajan tilastot alustetaan registerin yhteydessä, mutta jos kuitenkin tulen lisäämään jotain kenttiä jälkikäteen, jätän mergen päälle, jotta tietoja ei ylikirjoiteta tms. https://stackoverflow.com/questions/46597327/difference-between-firestore-set-with-merge-true-and-update |
| __15.4__ | Toteutin nyt StatsContextin, jota käytetään kun käyttäjä on kirjautunut (AppNavigator). Toteutin Contextin samalla tavalla kun aiemman AuthContextin. Tässä huomasin, että AuthContext ei ole luotu täysin modulaarisesti. En kuitenkaan sitä lähtenyt vielä muuttamaan, mutta tein uuden contextin siten, että logiikka ja contextin olemassaolon tarkistaminen ovat omissa hookeissaan. Näiden lisäski muotoilin GameBoardin koodia järkevämpään muotoon (resultien tallennuksen suhteen) ja erotin logikaan pelin aikana ja pelin päätyttyä eri useEffecteihin. Myös kutsun nyt statsien päivitystä suoraan pelin jälkeen, jotta käyttäjä kykenee saamaan statseja tarkastellessaan oikean kuvan siitä, missä mennään eikä hakulogiikkaa tarvise toteuttaa statsScreen komponentissa. Huomasin, että käyttäjän pisteet voivat useamman häviön jälkeen mennä negatiivisiksi. Pitää jossain vaiheessa tehdä logiikka, jossa haetaan pistemäärä ja laittaa siten, että alle nollan ei voida mennä. <br><br>
Mietin myös, miten on parasta toteuttaa getDoc haku. Itsellä ei ole sellaista todella kriittistä reaaliaikasta tietoa, minkä vuoksi en laittanut onSnapshot listeneriä vaan toteutin tietojen hakemisen normaalilla getDoc haulla tämän dokumentaation mukaisesti: https://firebase.google.com/docs/firestore/query-data/get-data.
